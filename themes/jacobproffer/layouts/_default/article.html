{{ $thumbnail := "" }}

{{ if isset .Params "thumbnail" }}

  {{ $thumbnail = .Params.thumbnail }}

{{ else }}

  {{ $thumbnail = "/images/background.jpg" }}

{{ end }}

{{ $thumbnailSrc := resources.Get $thumbnail }}
{{ $thumbnailAlt := .Params.thumbnailAlt }}

{{ $smallw := default "370x webp" }}
{{ $tabletw := default "389x webp" }}
{{ $mediumw := default "464x webp" }}
{{ $desktopw := default "384x webp" }}

{{ $data := newScratch }}
{{ $data.Set "small" ($thumbnailSrc.Resize $smallw) }}
{{ $data.Set "tablet" ($thumbnailSrc.Resize $tabletw) }}
{{ $data.Set "medium" ($thumbnailSrc.Resize $mediumw) }}
{{ $data.Set "desktop" ($thumbnailSrc.Resize $desktopw) }}

{{ $small := $data.Get "small" }}
{{ $tablet := $data.Get "tablet" }}
{{ $medium := $data.Get "medium" }}
{{ $desktop := $data.Get "desktop" }}

<div class="article grid relative" role="group" aria-label="article">

  <div class="article__copy grid">

    <h2 class="h3">{{ .Title }}</h2>

    {{ if isset .Params "categories" }}

      <div class="article__type">
        <span class="font-14">{{ .Type | title }}</span>
      </div>

    {{ end }}

  </div>

  {{ if isset .Params "thumbnail" }}

    <div class="article__thumbnail overflow-hidden">

      <picture>

        <source media="(max-width: 480px)" srcset="{{with $small.RelPermalink }}{{.}}{{ end }}" width="{{ $small.Width }}" height="{{ $small.Height }}">
        <source media="(max-width: 1079px)" srcset="{{with $tablet.RelPermalink }}{{.}}{{ end }}" width="{{ $tablet.Width }}" height="{{ $tablet.Height }}">
        <source media="(max-width: 1439px)" srcset="{{with $medium.RelPermalink }}{{.}}{{ end }}" width="{{ $medium.Width }}" height="{{ $medium.Height }}">
        <source media="(min-width: 1600px)" srcset="{{with $desktop.RelPermalink }}{{.}}{{ end }}" width="{{ $desktop.Width }}" height="{{ $desktop.Height }}">

        <img
          class="article__thumbnail-image image-cover"
          src="{{ $thumbnailSrc.RelPermalink }}"
          width="616"
          height="482"
          alt="{{ with $thumbnailAlt }}{{ . }}{{ end }}"
          loading="lazy"
        >
      </picture>

    </div>

  {{ end }}

  <a class="article__link absolute-link" href="{{ .Permalink }}" aria-label="View {{ .Title }}"></a>

</div>
